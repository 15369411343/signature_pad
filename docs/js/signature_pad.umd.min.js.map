{"version":3,"file":"signature_pad.umd.min.js","sources":["../node_modules/tslib/tslib.es6.js","../src/point.ts","../src/bezier.ts","../src/signature_pad.ts","../src/throttle.ts","../src/signature_event_target.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","// Interface for point data structure used e.g. in SignaturePad#fromData method\r\nexport interface BasicPoint {\r\n  x: number;\r\n  y: number;\r\n  pressure: number;\r\n  time: number;\r\n}\r\n\r\nexport class Point implements BasicPoint {\r\n  public x: number;\r\n  public y: number;\r\n  public pressure: number;\r\n  public time: number;\r\n\r\n  constructor(x: number, y: number, pressure?: number, time?: number) {\r\n    if (isNaN(x) || isNaN(y)) {\r\n      throw new Error(`Point is invalid: (${x}, ${y})`);\r\n    }\r\n    this.x = +x;\r\n    this.y = +y;\r\n    this.pressure = pressure || 0;\r\n    this.time = time || Date.now();\r\n  }\r\n\r\n  public distanceTo(start: BasicPoint): number {\r\n    return Math.sqrt(\r\n      Math.pow(this.x - start.x, 2) + Math.pow(this.y - start.y, 2),\r\n    );\r\n  }\r\n\r\n  public equals(other: BasicPoint): boolean {\r\n    return (\r\n      this.x === other.x &&\r\n      this.y === other.y &&\r\n      this.pressure === other.pressure &&\r\n      this.time === other.time\r\n    );\r\n  }\r\n\r\n  public velocityFrom(start: BasicPoint): number {\r\n    return this.time !== start.time\r\n      ? this.distanceTo(start) / (this.time - start.time)\r\n      : 0;\r\n  }\r\n}\r\n","import { BasicPoint, Point } from './point';\r\n\r\nexport class Bezier {\r\n  public static fromPoints(\r\n    points: Point[],\r\n    widths: { start: number; end: number },\r\n  ): Bezier {\r\n    const c2 = this.calculateControlPoints(points[0], points[1], points[2]).c2;\r\n    const c3 = this.calculateControlPoints(points[1], points[2], points[3]).c1;\r\n\r\n    return new Bezier(points[1], c2, c3, points[2], widths.start, widths.end);\r\n  }\r\n\r\n  private static calculateControlPoints(\r\n    s1: BasicPoint,\r\n    s2: BasicPoint,\r\n    s3: BasicPoint,\r\n  ): {\r\n    c1: BasicPoint;\r\n    c2: BasicPoint;\r\n  } {\r\n    const dx1 = s1.x - s2.x;\r\n    const dy1 = s1.y - s2.y;\r\n    const dx2 = s2.x - s3.x;\r\n    const dy2 = s2.y - s3.y;\r\n\r\n    const m1 = { x: (s1.x + s2.x) / 2.0, y: (s1.y + s2.y) / 2.0 };\r\n    const m2 = { x: (s2.x + s3.x) / 2.0, y: (s2.y + s3.y) / 2.0 };\r\n\r\n    const l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\r\n    const l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\r\n\r\n    const dxm = m1.x - m2.x;\r\n    const dym = m1.y - m2.y;\r\n\r\n    const k = l1 + l2 == 0 ? 0 : l2 / (l1 + l2);\r\n    const cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\r\n\r\n    const tx = s2.x - cm.x;\r\n    const ty = s2.y - cm.y;\r\n\r\n    return {\r\n      c1: new Point(m1.x + tx, m1.y + ty),\r\n      c2: new Point(m2.x + tx, m2.y + ty),\r\n    };\r\n  }\r\n\r\n  constructor(\r\n    public startPoint: Point,\r\n    public control2: BasicPoint,\r\n    public control1: BasicPoint,\r\n    public endPoint: Point,\r\n    public startWidth: number,\r\n    public endWidth: number,\r\n  ) {}\r\n\r\n  // Returns approximated length. Code taken from https://www.lemoda.net/maths/bezier-length/index.html.\r\n  public length(): number {\r\n    const steps = 10;\r\n    let length = 0;\r\n    let px;\r\n    let py;\r\n\r\n    for (let i = 0; i <= steps; i += 1) {\r\n      const t = i / steps;\r\n      const cx = this.point(\r\n        t,\r\n        this.startPoint.x,\r\n        this.control1.x,\r\n        this.control2.x,\r\n        this.endPoint.x,\r\n      );\r\n      const cy = this.point(\r\n        t,\r\n        this.startPoint.y,\r\n        this.control1.y,\r\n        this.control2.y,\r\n        this.endPoint.y,\r\n      );\r\n\r\n      if (i > 0) {\r\n        const xdiff = cx - (px as number);\r\n        const ydiff = cy - (py as number);\r\n\r\n        length += Math.sqrt(xdiff * xdiff + ydiff * ydiff);\r\n      }\r\n\r\n      px = cx;\r\n      py = cy;\r\n    }\r\n\r\n    return length;\r\n  }\r\n\r\n  // Calculate parametric value of x or y given t and the four point coordinates of a cubic bezier curve.\r\n  private point(\r\n    t: number,\r\n    start: number,\r\n    c1: number,\r\n    c2: number,\r\n    end: number,\r\n  ): number {\r\n    // prettier-ignore\r\n    return (       start * (1.0 - t) * (1.0 - t)  * (1.0 - t))\r\n         + (3.0 *  c1    * (1.0 - t) * (1.0 - t)  * t)\r\n         + (3.0 *  c2    * (1.0 - t) * t          * t)\r\n         + (       end   * t         * t          * t);\r\n  }\r\n}\r\n","/**\r\n * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:\r\n * http://corner.squareup.com/2012/07/smoother-signatures.html\r\n *\r\n * Implementation of interpolation using cubic Bézier curves is taken from:\r\n * https://web.archive.org/web/20160323213433/http://www.benknowscode.com/2012/09/path-interpolation-using-cubic-bezier_9742.html\r\n *\r\n * Algorithm for approximated length of a Bézier curve is taken from:\r\n * http://www.lemoda.net/maths/bezier-length/index.html\r\n */\r\n\r\nimport { Bezier } from './bezier';\r\nimport { BasicPoint, Point } from './point';\r\nimport { SignatureEventTarget } from './signature_event_target';\r\nimport { throttle } from './throttle';\r\n\r\nexport { BasicPoint } from './point';\r\n\r\nexport interface SignatureEvent {\r\n  event: MouseEvent | TouchEvent | PointerEvent;\r\n  type: string;\r\n  x: number;\r\n  y: number;\r\n  pressure: number;\r\n}\r\n\r\nexport interface FromDataOptions {\r\n  clear?: boolean;\r\n}\r\n\r\nexport interface ToSVGOptions {\r\n  includeBackgroundColor?: boolean;\r\n}\r\n\r\nexport interface PointGroupOptions {\r\n  dotSize: number;\r\n  minWidth: number;\r\n  maxWidth: number;\r\n  penColor: string;\r\n  velocityFilterWeight: number;\r\n  /**\r\n   * This is the globalCompositeOperation for the line.\r\n   * *default: 'source-over'*\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\r\n   */\r\n  compositeOperation: GlobalCompositeOperation;\r\n}\r\n\r\nexport interface Options extends Partial<PointGroupOptions> {\r\n  minDistance?: number;\r\n  backgroundColor?: string;\r\n  throttle?: number;\r\n  canvasContextOptions?: CanvasRenderingContext2DSettings;\r\n}\r\n\r\nexport interface PointGroup extends PointGroupOptions {\r\n  points: BasicPoint[];\r\n}\r\n\r\nexport default class SignaturePad extends SignatureEventTarget {\r\n  // Public stuff\r\n  public dotSize: number;\r\n  public minWidth: number;\r\n  public maxWidth: number;\r\n  public penColor: string;\r\n  public minDistance: number;\r\n  public velocityFilterWeight: number;\r\n  public compositeOperation: GlobalCompositeOperation;\r\n  public backgroundColor: string;\r\n  public throttle: number;\r\n  public canvasContextOptions: CanvasRenderingContext2DSettings;\r\n\r\n  // Private stuff\r\n  /* tslint:disable: variable-name */\r\n  private _ctx: CanvasRenderingContext2D;\r\n  private _drawingStroke = false;\r\n  private _isEmpty = true;\r\n  private _lastPoints: Point[] = []; // Stores up to 4 most recent points; used to generate a new curve\r\n  private _data: PointGroup[] = []; // Stores all points in groups (one group per line or dot)\r\n  private _lastVelocity = 0;\r\n  private _lastWidth = 0;\r\n  private _strokeMoveUpdate: (event: SignatureEvent) => void;\r\n  /* tslint:enable: variable-name */\r\n\r\n  constructor(\r\n    private canvas: HTMLCanvasElement,\r\n    options: Options = {},\r\n  ) {\r\n    super();\r\n    this.velocityFilterWeight = options.velocityFilterWeight || 0.7;\r\n    this.minWidth = options.minWidth || 0.5;\r\n    this.maxWidth = options.maxWidth || 2.5;\r\n\r\n    // We need to handle 0 value, so use `??` instead of `||`\r\n    this.throttle = options.throttle ?? 16; // in milliseconds\r\n    this.minDistance = options.minDistance ?? 5; // in pixels\r\n    this.dotSize = options.dotSize || 0;\r\n    this.penColor = options.penColor || 'black';\r\n    this.backgroundColor = options.backgroundColor || 'rgba(0,0,0,0)';\r\n    this.compositeOperation = options.compositeOperation || 'source-over';\r\n    this.canvasContextOptions = options.canvasContextOptions ?? {};\r\n\r\n    this._strokeMoveUpdate = this.throttle\r\n      ? throttle(SignaturePad.prototype._strokeUpdate, this.throttle)\r\n      : SignaturePad.prototype._strokeUpdate;\r\n    this._ctx = canvas.getContext(\r\n      '2d',\r\n      this.canvasContextOptions,\r\n    ) as CanvasRenderingContext2D;\r\n\r\n    this.clear();\r\n\r\n    // Enable mouse and touch event handlers\r\n    this.on();\r\n  }\r\n\r\n  public clear(): void {\r\n    const { _ctx: ctx, canvas } = this;\r\n\r\n    // Clear canvas using background color\r\n    ctx.fillStyle = this.backgroundColor;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n    this._data = [];\r\n    this._reset(this._getPointGroupOptions());\r\n    this._isEmpty = true;\r\n  }\r\n\r\n  public fromDataURL(\r\n    dataUrl: string,\r\n    options: {\r\n      ratio?: number;\r\n      width?: number;\r\n      height?: number;\r\n      xOffset?: number;\r\n      yOffset?: number;\r\n    } = {},\r\n  ): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const image = new Image();\r\n      const ratio = options.ratio || window.devicePixelRatio || 1;\r\n      const width = options.width || this.canvas.width / ratio;\r\n      const height = options.height || this.canvas.height / ratio;\r\n      const xOffset = options.xOffset || 0;\r\n      const yOffset = options.yOffset || 0;\r\n\r\n      this._reset(this._getPointGroupOptions());\r\n\r\n      image.onload = (): void => {\r\n        this._ctx.drawImage(image, xOffset, yOffset, width, height);\r\n        resolve();\r\n      };\r\n      image.onerror = (error): void => {\r\n        reject(error);\r\n      };\r\n      image.crossOrigin = 'anonymous';\r\n      image.src = dataUrl;\r\n\r\n      this._isEmpty = false;\r\n    });\r\n  }\r\n\r\n  public toDataURL(\r\n    type: 'image/svg+xml',\r\n    encoderOptions?: ToSVGOptions,\r\n  ): string;\r\n  public toDataURL(type?: string, encoderOptions?: number): string;\r\n  public toDataURL(\r\n    type = 'image/png',\r\n    encoderOptions?: number | ToSVGOptions | undefined,\r\n  ): string {\r\n    switch (type) {\r\n      case 'image/svg+xml':\r\n        if (typeof encoderOptions !== 'object') {\r\n          encoderOptions = undefined;\r\n        }\r\n        return `data:image/svg+xml;base64,${btoa(\r\n          this.toSVG(encoderOptions as ToSVGOptions),\r\n        )}`;\r\n      default:\r\n        if (typeof encoderOptions !== 'number') {\r\n          encoderOptions = undefined;\r\n        }\r\n        return this.canvas.toDataURL(type, encoderOptions);\r\n    }\r\n  }\r\n\r\n  public on(): void {\r\n    // Disable panning/zooming when touching canvas element\r\n    this.canvas.style.touchAction = 'none';\r\n    (this.canvas.style as CSSStyleDeclaration & { msTouchAction: string | null }).msTouchAction = 'none';\r\n    this.canvas.style.userSelect = 'none';\r\n\r\n    const isIOS =\r\n      /Macintosh/.test(navigator.userAgent) && 'ontouchstart' in document;\r\n\r\n    // The \"Scribble\" feature of iOS intercepts point events. So that we can\r\n    // lose some of them when tapping rapidly. Use touch events for iOS\r\n    // platforms to prevent it. See\r\n    // https://developer.apple.com/forums/thread/664108 for more information.\r\n    if (window.PointerEvent && !isIOS) {\r\n      this._handlePointerEvents();\r\n    } else {\r\n      this._handleMouseEvents();\r\n\r\n      if ('ontouchstart' in window) {\r\n        this._handleTouchEvents();\r\n      }\r\n    }\r\n  }\r\n\r\n  public off(): void {\r\n    // Enable panning/zooming when touching canvas element\r\n    this.canvas.style.touchAction = 'auto';\r\n    (this.canvas.style as CSSStyleDeclaration & { msTouchAction: string | null }).msTouchAction = 'auto';\r\n    this.canvas.style.userSelect = 'auto';\r\n\r\n    this.canvas.removeEventListener('pointerdown', this._handlePointerDown);\r\n    this.canvas.removeEventListener('mousedown', this._handleMouseDown);\r\n    this.canvas.removeEventListener('touchstart', this._handleTouchStart);\r\n\r\n    this._removeMoveUpEventListeners();\r\n  }\r\n\r\n  private _getListenerFunctions() {\r\n    const canvasWindow =\r\n      window.document === this.canvas.ownerDocument\r\n        ? window\r\n        : this.canvas.ownerDocument.defaultView ?? this.canvas.ownerDocument;\r\n\r\n    return {\r\n      addEventListener: canvasWindow.addEventListener.bind(\r\n        canvasWindow,\r\n      ) as typeof window.addEventListener,\r\n      removeEventListener: canvasWindow.removeEventListener.bind(\r\n        canvasWindow,\r\n      ) as typeof window.removeEventListener,\r\n    };\r\n  }\r\n\r\n  private _removeMoveUpEventListeners(): void {\r\n    const { removeEventListener } = this._getListenerFunctions();\r\n    removeEventListener('pointermove', this._handlePointerMove);\r\n    removeEventListener('pointerup', this._handlePointerUp);\r\n\r\n    removeEventListener('mousemove', this._handleMouseMove);\r\n    removeEventListener('mouseup', this._handleMouseUp);\r\n\r\n    removeEventListener('touchmove', this._handleTouchMove);\r\n    removeEventListener('touchend', this._handleTouchEnd);\r\n  }\r\n\r\n  public isEmpty(): boolean {\r\n    return this._isEmpty;\r\n  }\r\n\r\n  public fromData(\r\n    pointGroups: PointGroup[],\r\n    { clear = true }: FromDataOptions = {},\r\n  ): void {\r\n    if (clear) {\r\n      this.clear();\r\n    }\r\n\r\n    this._fromData(\r\n      pointGroups,\r\n      this._drawCurve.bind(this),\r\n      this._drawDot.bind(this),\r\n    );\r\n\r\n    this._data = this._data.concat(pointGroups);\r\n  }\r\n\r\n  public toData(): PointGroup[] {\r\n    return this._data;\r\n  }\r\n\r\n  public _isLeftButtonPressed(event: MouseEvent, only?: boolean): boolean {\r\n    if (only) {\r\n      return event.buttons === 1;\r\n    }\r\n\r\n    return (event.buttons & 1) === 1;\r\n  }\r\n  private _pointerEventToSignatureEvent(\r\n    event: MouseEvent | PointerEvent,\r\n  ): SignatureEvent {\r\n    return {\r\n      event: event,\r\n      type: event.type,\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n      pressure: 'pressure' in event ? event.pressure : 0,\r\n    };\r\n  }\r\n\r\n  private _touchEventToSignatureEvent(event: TouchEvent): SignatureEvent {\r\n    const touch = event.changedTouches[0];\r\n    return {\r\n      event: event,\r\n      type: event.type,\r\n      x: touch.clientX,\r\n      y: touch.clientY,\r\n      pressure: touch.force,\r\n    };\r\n  }\r\n\r\n  // Event handlers\r\n  private _handleMouseDown = (event: MouseEvent): void => {\r\n    if (!this._isLeftButtonPressed(event, true) || this._drawingStroke) {\r\n      return;\r\n    }\r\n    this._strokeBegin(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handleMouseMove = (event: MouseEvent): void => {\r\n    if (!this._isLeftButtonPressed(event, true) || !this._drawingStroke) {\r\n      // Stop when not pressing primary button or pressing multiple buttons\r\n      this._strokeEnd(this._pointerEventToSignatureEvent(event), false);\r\n      return;\r\n    }\r\n\r\n    this._strokeMoveUpdate(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handleMouseUp = (event: MouseEvent): void => {\r\n    if (this._isLeftButtonPressed(event)) {\r\n      return;\r\n    }\r\n\r\n    this._strokeEnd(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handleTouchStart = (event: TouchEvent): void => {\r\n    if (event.targetTouches.length !== 1 || this._drawingStroke) {\r\n      return;\r\n    }\r\n\r\n    // Prevent scrolling.\r\n    if (event.cancelable) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    this._strokeBegin(this._touchEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handleTouchMove = (event: TouchEvent): void => {\r\n    if (event.targetTouches.length !== 1) {\r\n      return;\r\n    }\r\n\r\n    // Prevent scrolling.\r\n    if (event.cancelable) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (!this._drawingStroke) {\r\n      this._strokeEnd(this._touchEventToSignatureEvent(event), false);\r\n      return;\r\n    }\r\n\r\n    this._strokeMoveUpdate(this._touchEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handleTouchEnd = (event: TouchEvent): void => {\r\n    if (event.targetTouches.length !== 0) {\r\n      return;\r\n    }\r\n\r\n    if (event.cancelable) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    this.canvas.removeEventListener('touchmove', this._handleTouchMove);\r\n\r\n    this._strokeEnd(this._touchEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handlePointerDown = (event: PointerEvent): void => {\r\n    if (!event.isPrimary || !this._isLeftButtonPressed(event) || this._drawingStroke) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n\r\n    this._strokeBegin(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handlePointerMove = (event: PointerEvent): void => {\r\n    if (!event.isPrimary) {\r\n      return;\r\n    }\r\n    if (!this._isLeftButtonPressed(event, true) || !this._drawingStroke) {\r\n      // Stop when primary button not pressed or multiple buttons pressed\r\n      this._strokeEnd(this._pointerEventToSignatureEvent(event), false);\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n    this._strokeMoveUpdate(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _handlePointerUp = (event: PointerEvent): void => {\r\n    if (!event.isPrimary || this._isLeftButtonPressed(event)) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n    this._strokeEnd(this._pointerEventToSignatureEvent(event));\r\n  };\r\n\r\n  private _getPointGroupOptions(group?: PointGroup): PointGroupOptions {\r\n    return {\r\n      penColor: group && 'penColor' in group ? group.penColor : this.penColor,\r\n      dotSize: group && 'dotSize' in group ? group.dotSize : this.dotSize,\r\n      minWidth: group && 'minWidth' in group ? group.minWidth : this.minWidth,\r\n      maxWidth: group && 'maxWidth' in group ? group.maxWidth : this.maxWidth,\r\n      velocityFilterWeight:\r\n        group && 'velocityFilterWeight' in group\r\n          ? group.velocityFilterWeight\r\n          : this.velocityFilterWeight,\r\n      compositeOperation:\r\n        group && 'compositeOperation' in group\r\n          ? group.compositeOperation\r\n          : this.compositeOperation,\r\n    };\r\n  }\r\n\r\n  // Private methods\r\n  private _strokeBegin(event: SignatureEvent): void {\r\n    let e: CustomEvent;\r\n    try {\r\n      e = new CustomEvent('beginStroke', { detail: event, cancelable: true });\r\n    } catch {\r\n      e = document.createEvent('CustomEvent');\r\n      e.initCustomEvent('beginStroke', false, true, event);\r\n    }\r\n    const cancelled = !this.dispatchEvent(e);\r\n    if (cancelled) {\r\n      return;\r\n    }\r\n\r\n    const { addEventListener } = this._getListenerFunctions();\r\n    switch (event.event.type) {\r\n      case 'mousedown':\r\n        addEventListener('mousemove', this._handleMouseMove);\r\n        addEventListener('mouseup', this._handleMouseUp);\r\n        break;\r\n      case 'touchstart':\r\n        addEventListener('touchmove', this._handleTouchMove);\r\n        addEventListener('touchend', this._handleTouchEnd);\r\n        break;\r\n      case 'pointerdown':\r\n        addEventListener('pointermove', this._handlePointerMove);\r\n        addEventListener('pointerup', this._handlePointerUp);\r\n        break;\r\n      default:\r\n      // do nothing\r\n    }\r\n\r\n    this._drawingStroke = true;\r\n\r\n    const pointGroupOptions = this._getPointGroupOptions();\r\n\r\n    const newPointGroup: PointGroup = {\r\n      ...pointGroupOptions,\r\n      points: [],\r\n    };\r\n\r\n    this._data.push(newPointGroup);\r\n    this._reset(pointGroupOptions);\r\n    this._strokeUpdate(event);\r\n  }\r\n\r\n  private _strokeUpdate(event: SignatureEvent): void {\r\n    if (!this._drawingStroke) {\r\n      return;\r\n    }\r\n\r\n    if (this._data.length === 0) {\r\n      // This can happen if clear() was called while a signature is still in progress,\r\n      // or if there is a race condition between start/update events.\r\n      this._strokeBegin(event);\r\n      return;\r\n    }\r\n\r\n    let e: CustomEvent;\r\n    try {\r\n      e = new CustomEvent('beforeUpdateStroke', { detail: event });\r\n    } catch {\r\n      e = document.createEvent('CustomEvent');\r\n      e.initCustomEvent('beforeUpdateStroke', false, false, event);\r\n    }\r\n    this.dispatchEvent(e);\r\n\r\n    const point = this._createPoint(event.x, event.y, event.pressure);\r\n    const lastPointGroup = this._data[this._data.length - 1];\r\n    const lastPoints = lastPointGroup.points;\r\n    const lastPoint =\r\n      lastPoints.length > 0 && lastPoints[lastPoints.length - 1];\r\n    const isLastPointTooClose = lastPoint\r\n      ? point.distanceTo(lastPoint) <= this.minDistance\r\n      : false;\r\n    const pointGroupOptions = this._getPointGroupOptions(lastPointGroup);\r\n\r\n    // Skip this point if it's too close to the previous one\r\n    if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\r\n      const curve = this._addPoint(point, pointGroupOptions);\r\n\r\n      if (!lastPoint) {\r\n        this._drawDot(point, pointGroupOptions);\r\n      } else if (curve) {\r\n        this._drawCurve(curve, pointGroupOptions);\r\n      }\r\n\r\n      lastPoints.push({\r\n        time: point.time,\r\n        x: point.x,\r\n        y: point.y,\r\n        pressure: point.pressure,\r\n      });\r\n    }\r\n\r\n    try {\r\n      e = new CustomEvent('afterUpdateStroke', { detail: event });\r\n    } catch {\r\n      e = document.createEvent('CustomEvent');\r\n      e.initCustomEvent('afterUpdateStroke', false, false, event);\r\n    }\r\n    this.dispatchEvent(e);\r\n  }\r\n\r\n  private _strokeEnd(event: SignatureEvent, shouldUpdate = true): void {\r\n    this._removeMoveUpEventListeners();\r\n\r\n    if (!this._drawingStroke) {\r\n      return;\r\n    }\r\n\r\n    if (shouldUpdate) {\r\n      this._strokeUpdate(event);\r\n    }\r\n\r\n    this._drawingStroke = false;\r\n    let e: CustomEvent;\r\n    try {\r\n      e = new CustomEvent('endStroke', { detail: event });\r\n    } catch {\r\n      e = document.createEvent('CustomEvent');\r\n      e.initCustomEvent('endStroke', false, false, event);\r\n    }\r\n    this.dispatchEvent(e);\r\n  }\r\n\r\n  private _handlePointerEvents(): void {\r\n    this._drawingStroke = false;\r\n\r\n    this.canvas.addEventListener('pointerdown', this._handlePointerDown);\r\n  }\r\n\r\n  private _handleMouseEvents(): void {\r\n    this._drawingStroke = false;\r\n\r\n    this.canvas.addEventListener('mousedown', this._handleMouseDown);\r\n  }\r\n\r\n  private _handleTouchEvents(): void {\r\n    this.canvas.addEventListener('touchstart', this._handleTouchStart);\r\n  }\r\n\r\n  // Called when a new line is started\r\n  private _reset(options: PointGroupOptions): void {\r\n    this._lastPoints = [];\r\n    this._lastVelocity = 0;\r\n    this._lastWidth = (options.minWidth + options.maxWidth) / 2;\r\n    this._ctx.fillStyle = options.penColor;\r\n    this._ctx.globalCompositeOperation = options.compositeOperation;\r\n  }\r\n\r\n  private _createPoint(x: number, y: number, pressure: number): Point {\r\n    const rect = this.canvas.getBoundingClientRect();\r\n\r\n    return new Point(\r\n      x - rect.left,\r\n      y - rect.top,\r\n      pressure,\r\n      new Date().getTime(),\r\n    );\r\n  }\r\n\r\n  // Add point to _lastPoints array and generate a new curve if there are enough points (i.e. 3)\r\n  private _addPoint(point: Point, options: PointGroupOptions): Bezier | null {\r\n    const { _lastPoints } = this;\r\n\r\n    _lastPoints.push(point);\r\n\r\n    if (_lastPoints.length > 2) {\r\n      // To reduce the initial lag make it work with 3 points\r\n      // by copying the first point to the beginning.\r\n      if (_lastPoints.length === 3) {\r\n        _lastPoints.unshift(_lastPoints[0]);\r\n      }\r\n\r\n      // _points array will always have 4 points here.\r\n      const widths = this._calculateCurveWidths(\r\n        _lastPoints[1],\r\n        _lastPoints[2],\r\n        options,\r\n      );\r\n      const curve = Bezier.fromPoints(_lastPoints, widths);\r\n\r\n      // Remove the first element from the list, so that there are no more than 4 points at any time.\r\n      _lastPoints.shift();\r\n\r\n      return curve;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private _calculateCurveWidths(\r\n    startPoint: Point,\r\n    endPoint: Point,\r\n    options: PointGroupOptions,\r\n  ): { start: number; end: number } {\r\n    const velocity =\r\n      options.velocityFilterWeight * endPoint.velocityFrom(startPoint) +\r\n      (1 - options.velocityFilterWeight) * this._lastVelocity;\r\n\r\n    const newWidth = this._strokeWidth(velocity, options);\r\n\r\n    const widths = {\r\n      end: newWidth,\r\n      start: this._lastWidth,\r\n    };\r\n\r\n    this._lastVelocity = velocity;\r\n    this._lastWidth = newWidth;\r\n\r\n    return widths;\r\n  }\r\n\r\n  private _strokeWidth(velocity: number, options: PointGroupOptions): number {\r\n    return Math.max(options.maxWidth / (velocity + 1), options.minWidth);\r\n  }\r\n\r\n  private _drawCurveSegment(x: number, y: number, width: number): void {\r\n    const ctx = this._ctx;\r\n\r\n    ctx.moveTo(x, y);\r\n    ctx.arc(x, y, width, 0, 2 * Math.PI, false);\r\n    this._isEmpty = false;\r\n  }\r\n\r\n  private _drawCurve(curve: Bezier, options: PointGroupOptions): void {\r\n    const ctx = this._ctx;\r\n    const widthDelta = curve.endWidth - curve.startWidth;\r\n    // '2' is just an arbitrary number here. If only length is used, then\r\n    // there are gaps between curve segments :/\r\n    const drawSteps = Math.ceil(curve.length()) * 2;\r\n\r\n    ctx.beginPath();\r\n    ctx.fillStyle = options.penColor;\r\n\r\n    for (let i = 0; i < drawSteps; i += 1) {\r\n      // Calculate the Bezier (x, y) coordinate for this step.\r\n      const t = i / drawSteps;\r\n      const tt = t * t;\r\n      const ttt = tt * t;\r\n      const u = 1 - t;\r\n      const uu = u * u;\r\n      const uuu = uu * u;\r\n\r\n      let x = uuu * curve.startPoint.x;\r\n      x += 3 * uu * t * curve.control1.x;\r\n      x += 3 * u * tt * curve.control2.x;\r\n      x += ttt * curve.endPoint.x;\r\n\r\n      let y = uuu * curve.startPoint.y;\r\n      y += 3 * uu * t * curve.control1.y;\r\n      y += 3 * u * tt * curve.control2.y;\r\n      y += ttt * curve.endPoint.y;\r\n\r\n      const width = Math.min(\r\n        curve.startWidth + ttt * widthDelta,\r\n        options.maxWidth,\r\n      );\r\n      this._drawCurveSegment(x, y, width);\r\n    }\r\n\r\n    ctx.closePath();\r\n    ctx.fill();\r\n  }\r\n\r\n  private _drawDot(point: BasicPoint, options: PointGroupOptions): void {\r\n    const ctx = this._ctx;\r\n    const width =\r\n      options.dotSize > 0\r\n        ? options.dotSize\r\n        : (options.minWidth + options.maxWidth) / 2;\r\n\r\n    ctx.beginPath();\r\n    this._drawCurveSegment(point.x, point.y, width);\r\n    ctx.closePath();\r\n    ctx.fillStyle = options.penColor;\r\n    ctx.fill();\r\n  }\r\n\r\n  private _fromData(\r\n    pointGroups: PointGroup[],\r\n    drawCurve: SignaturePad['_drawCurve'],\r\n    drawDot: SignaturePad['_drawDot'],\r\n  ): void {\r\n    for (const group of pointGroups) {\r\n      const { points } = group;\r\n      const pointGroupOptions = this._getPointGroupOptions(group);\r\n\r\n      if (points.length > 1) {\r\n        for (let j = 0; j < points.length; j += 1) {\r\n          const basicPoint = points[j];\r\n          const point = new Point(\r\n            basicPoint.x,\r\n            basicPoint.y,\r\n            basicPoint.pressure,\r\n            basicPoint.time,\r\n          );\r\n\r\n          if (j === 0) {\r\n            this._reset(pointGroupOptions);\r\n          }\r\n\r\n          const curve = this._addPoint(point, pointGroupOptions);\r\n\r\n          if (curve) {\r\n            drawCurve(curve, pointGroupOptions);\r\n          }\r\n        }\r\n      } else {\r\n        this._reset(pointGroupOptions);\r\n\r\n        drawDot(points[0], pointGroupOptions);\r\n      }\r\n    }\r\n  }\r\n\r\n  public toSVG({ includeBackgroundColor = false }: ToSVGOptions = {}): string {\r\n    const pointGroups = this._data;\r\n    const ratio = Math.max(window.devicePixelRatio || 1, 1);\r\n    const minX = 0;\r\n    const minY = 0;\r\n    const maxX = this.canvas.width / ratio;\r\n    const maxY = this.canvas.height / ratio;\r\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n\r\n    svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\r\n    svg.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n    svg.setAttribute('viewBox', `${minX} ${minY} ${maxX} ${maxY}`);\r\n    svg.setAttribute('width', maxX.toString());\r\n    svg.setAttribute('height', maxY.toString());\r\n\r\n    if (includeBackgroundColor && this.backgroundColor) {\r\n      const rect = document.createElement('rect');\r\n      rect.setAttribute('width', '100%');\r\n      rect.setAttribute('height', '100%');\r\n      rect.setAttribute('fill', this.backgroundColor);\r\n\r\n      svg.appendChild(rect);\r\n    }\r\n\r\n    this._fromData(\r\n      pointGroups,\r\n\r\n      (curve, { penColor }) => {\r\n        const path = document.createElement('path');\r\n\r\n        // Need to check curve for NaN values, these pop up when drawing\r\n        // lines on the canvas that are not continuous. E.g. Sharp corners\r\n        // or stopping mid-stroke and than continuing without lifting mouse.\r\n        if (\r\n          !isNaN(curve.control1.x) &&\r\n          !isNaN(curve.control1.y) &&\r\n          !isNaN(curve.control2.x) &&\r\n          !isNaN(curve.control2.y)\r\n        ) {\r\n          const attr =\r\n            `M ${curve.startPoint.x.toFixed(3)},${curve.startPoint.y.toFixed(\r\n              3,\r\n            )} ` +\r\n            `C ${curve.control1.x.toFixed(3)},${curve.control1.y.toFixed(3)} ` +\r\n            `${curve.control2.x.toFixed(3)},${curve.control2.y.toFixed(3)} ` +\r\n            `${curve.endPoint.x.toFixed(3)},${curve.endPoint.y.toFixed(3)}`;\r\n          path.setAttribute('d', attr);\r\n          path.setAttribute('stroke-width', (curve.endWidth * 2.25).toFixed(3));\r\n          path.setAttribute('stroke', penColor);\r\n          path.setAttribute('fill', 'none');\r\n          path.setAttribute('stroke-linecap', 'round');\r\n\r\n          svg.appendChild(path);\r\n        }\r\n      },\r\n\r\n      (point, { penColor, dotSize, minWidth, maxWidth }) => {\r\n        const circle = document.createElement('circle');\r\n        const size = dotSize > 0 ? dotSize : (minWidth + maxWidth) / 2;\r\n        circle.setAttribute('r', size.toString());\r\n        circle.setAttribute('cx', point.x.toString());\r\n        circle.setAttribute('cy', point.y.toString());\r\n        circle.setAttribute('fill', penColor);\r\n\r\n        svg.appendChild(circle);\r\n      },\r\n    );\r\n\r\n    return svg.outerHTML;\r\n  }\r\n}\r\n","/* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/no-this-alias */\r\n// Slightly simplified version of http://stackoverflow.com/a/27078401/815507\r\n\r\nexport function throttle(\r\n  fn: (...args: any[]) => any,\r\n  wait = 250,\r\n): (this: any, ...args: any[]) => any {\r\n  let previous = 0;\r\n  let timeout: number | null = null;\r\n  let result: any;\r\n  let storedContext: any;\r\n  let storedArgs: any[];\r\n\r\n  const later = (): void => {\r\n    previous = Date.now();\r\n    timeout = null;\r\n    result = fn.apply(storedContext, storedArgs);\r\n\r\n    if (!timeout) {\r\n      storedContext = null;\r\n      storedArgs = [];\r\n    }\r\n  };\r\n\r\n  return function wrapper(this: any, ...args: any[]): any {\r\n    const now = Date.now();\r\n    const remaining = wait - (now - previous);\r\n\r\n    storedContext = this;\r\n    storedArgs = args;\r\n\r\n    if (remaining <= 0 || remaining > wait) {\r\n      if (timeout) {\r\n        clearTimeout(timeout);\r\n        timeout = null;\r\n      }\r\n\r\n      previous = now;\r\n      result = fn.apply(storedContext, storedArgs);\r\n\r\n      if (!timeout) {\r\n        storedContext = null;\r\n        storedArgs = [];\r\n      }\r\n    } else if (!timeout) {\r\n      timeout = window.setTimeout(later, remaining);\r\n    }\r\n\r\n    return result;\r\n  };\r\n}\r\n","export class SignatureEventTarget {\r\n  /* tslint:disable: variable-name */\r\n  private _et: EventTarget;\r\n  /* tslint:enable: variable-name */\r\n\r\n  constructor() {\r\n    try {\r\n      this._et = new EventTarget();\r\n    } catch {\r\n      // Using document as EventTarget to support iOS 13 and older.\r\n      // Because EventTarget constructor just exists at iOS 14 and later.\r\n      this._et = document;\r\n    }\r\n  }\r\n\r\n  addEventListener(\r\n    type: string,\r\n    listener: EventListenerOrEventListenerObject | null,\r\n    options?: boolean | AddEventListenerOptions,\r\n  ): void {\r\n    this._et.addEventListener(type, listener, options);\r\n  }\r\n\r\n  dispatchEvent(event: Event): boolean {\r\n    return this._et.dispatchEvent(event);\r\n  }\r\n\r\n  removeEventListener(\r\n    type: string,\r\n    callback: EventListenerOrEventListenerObject | null,\r\n    options?: boolean | EventListenerOptions,\r\n  ): void {\r\n    this._et.removeEventListener(type, callback, options);\r\n  }\r\n}\r\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__assign","assign","t","s","i","n","arguments","length","apply","this","SuppressedError","Point","x","y","pressure","time","isNaN","Error","concat","Date","now","distanceTo","start","Math","sqrt","pow","equals","other","velocityFrom","Bezier","startPoint","control2","control1","endPoint","startWidth","endWidth","fromPoints","points","widths","c2","calculateControlPoints","c3","c1","end","s1","s2","s3","dx1","dy1","dx2","dy2","m1","m2","l1","l2","k","cm","tx","ty","px","py","cx","point","cy","xdiff","ydiff","SignaturePad","_super","canvas","options","_this","_drawingStroke","_isEmpty","_lastPoints","_data","_lastVelocity","_lastWidth","_handleMouseDown","event","_isLeftButtonPressed","_strokeBegin","_pointerEventToSignatureEvent","_handleMouseMove","_strokeMoveUpdate","_strokeEnd","_handleMouseUp","_handleTouchStart","targetTouches","cancelable","preventDefault","_touchEventToSignatureEvent","_handleTouchMove","_handleTouchEnd","removeEventListener","_handlePointerDown","isPrimary","_handlePointerMove","_handlePointerUp","velocityFilterWeight","minWidth","maxWidth","throttle","_a","minDistance","_b","dotSize","penColor","backgroundColor","compositeOperation","canvasContextOptions","_c","fn","wait","result","storedContext","storedArgs","previous","timeout","later","args","_i","remaining","clearTimeout","window","setTimeout","_strokeUpdate","_ctx","getContext","clear","on","TypeError","String","__","constructor","create","__extends","ctx","fillStyle","clearRect","width","height","fillRect","_reset","_getPointGroupOptions","fromDataURL","dataUrl","Promise","resolve","reject","image","Image","ratio","devicePixelRatio","xOffset","yOffset","onload","drawImage","onerror","error","crossOrigin","src","toDataURL","type","encoderOptions","undefined","btoa","toSVG","style","touchAction","msTouchAction","userSelect","isIOS","test","navigator","userAgent","document","PointerEvent","_handlePointerEvents","_handleMouseEvents","_handleTouchEvents","off","_removeMoveUpEventListeners","_getListenerFunctions","canvasWindow","ownerDocument","defaultView","addEventListener","bind","isEmpty","fromData","pointGroups","_fromData","_drawCurve","_drawDot","toData","only","buttons","clientX","clientY","touch","changedTouches","force","group","e","CustomEvent","detail","createEvent","initCustomEvent","dispatchEvent","pointGroupOptions","newPointGroup","push","_createPoint","lastPointGroup","lastPoints","lastPoint","isLastPointTooClose","curve","_addPoint","shouldUpdate","globalCompositeOperation","rect","getBoundingClientRect","left","top","getTime","unshift","_calculateCurveWidths","shift","velocity","newWidth","_strokeWidth","max","_drawCurveSegment","moveTo","arc","PI","widthDelta","drawSteps","ceil","beginPath","tt","ttt","u","uu","uuu","min","closePath","fill","drawCurve","drawDot","pointGroups_1","j","basicPoint","includeBackgroundColor","maxX","maxY","svg","createElementNS","setAttribute","toString","createElement","appendChild","path","attr","toFixed","circle","size","outerHTML","SignatureEventTarget","_et","EventTarget","listener","callback"],"mappings":"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","x_google_ignoreList":[0]}